---
title: "Homework1"
format: html
editor: visual
execute: 
  message: false
  warning: false
---

# Assessing Wastewater discharge in low income communities:

## Peter Vitale

In this project I hope to practice geo-spatial data visualization by:

-   Creating a clear and visually stimulating plot of the San Francisco Bay
-   Tying together plots of wastewater discharge and low income communities

I'm going to start by reading in the data and zoom in on the area I am focused on: South San Francisco Bay

```{r}
#| message: false
#| warning: false
# First, I'm going to load the necessary packages using p_load
pacman::p_load('tidyverse', 'sf', 'here', 'tmap')


# Read in geodatabase of EJScreen data at the Census Block Group level
ejscreen <- sf::st_read(here::here("data", 
                                   "ejscreen",
                                   "EJSCREEN_2023_BG_StatePct_with_AS_CNMI_GU_VI.gdb")) 

# Filter to a state you are interested in
california <- ejscreen %>%
  dplyr::filter(ST_ABBREV == "CA") 

# Filter to San Francisco Bay 
sf_bay_ej <- ejscreen %>%
  dplyr::filter(CNTY_NAME %in% c("Santa Clara County", 
                                 'Alameda County', 
                                 'Contra Costa County' , 
                                 'Marin County', 
                                 'Napa County', 
                                 'San Francisco County' , 
                                 'San Mateo County', 
                                 'Solano County', 
                                 'Sonoma County'))


# Drop NA's on the Wastewater column of the sf_bay_ej data
sf_bay_ej = sf_bay_ej %>% 
  drop_na('D2_PWDIS')

# I don't love this map without the iconic bay, so I am going to add the water

sf_bay_water <- st_read(dsn =here('data', 
                                  'sf-bay-shape', 
                                  'region_water_area.shp'))
```

Now I am going to start by plotting the South Bay Wastewater discharge

```{r}
#| warning: false
bbox_main <- st_bbox(c(xmin = -122.64 , 
                       xmax = -121.59 , 
                       ymax = 38.2 , 
                       ymin = 37.19),
                     crs = 4326) # This sets the bounding box and crs which aid in the view of the San Francisco Bay 
		
  
  
tm_shape(sf_bay_ej, bbox = bbox_main) + # We start with the base: the sf bay 
  tm_crs(4326) + # What view we want of the map 
  tm_polygons(fill = 'P_D2_PWDIS',
             fill.scale = tm_scale(values = c('#E1DABD',
                                              '#ABC798',
                                              '#FFC4EB',
                                              '#E6983F',
                                              '#A0185A',
                                              '#35012C'),
                                   breaks = c(0,50,80,90,95,100)), # This sets up my wastewater color scale and fills in the percentiles of wastewaters
             lty = 'blank', # Getting rid of the lines
             fill.legend = tm_legend(title = 'Wastewater\nDischarge\n(Percentile)', 
                                     reverse = TRUE, 
                                     width = 8,
                                     height = 9,
                                     title.fontfamily = 'monospace'))+ # Legend formatting
  tm_layout(bg.color = 'blue',
            legend.position = c('right','center'),
            legend.title.size = .8)+ # Background color and legend size + position
  tm_graticules()+ # This adds gridlines
tm_shape(sf_bay_water)+ # Lets get our SF bay water data in there
  tm_polygons(fill = 'blue',
              lty = 'blank')+
  tm_title('San Francisco Bay: Wastewater Discharge') # And cap it off with a title
  
```

```{r}
#| warning: FALSE
tm_shape(sf_bay_ej, bbox = bbox_main) + 
  tm_crs(4326) +
  tm_polygons(fill = 'LOWINCPCT', # This time im using percent income instead of wastewater
             fill.scale = tm_scale(values = c('#E1DABD',
                                              '#ABC798',
                                              '#E6983F',
                                              '#A0185A',
                                              '#35012C')),
             lty = 'blank',
             fill.legend = tm_legend(title = 'Percent Low\nIncome', 
                                     reverse = TRUE,
                                     width = 8,
                                     height = 9,
                                     title.fontfamily = 'monospace'))+
  tm_layout(bg.color = 'blue',
            legend.position = c('right','center'),
            legend.title.size = .8)+
  tm_graticules()+
tm_shape(sf_bay_water)+
  tm_polygons(fill = 'blue',
              lty = 'blank')+
tm_title('San Francisco Bay: Percentage Low Income')
```

The San Francisco Bay has [37 wastewater](https://www.sfpuc.gov/about-us/our-systems/sewer-system) treatment plants which run into the bay. The San Francisco Bay also has an increasingly high level of wealth disparity, with a gap of [\$126,800 between Silicon Valleyâ€™s highest and lowest earners](https://www.kron4.com/news/bay-area/silicon-valley-income-inequality/). I decided to compare where the wastewater was being dumped and the percentage of the population that is low income, in an attempt to ascertain if access to green spaces is reduced in low income areas. In the maps you can see some peaks in wastewater in San Jose and San Pablo. While the percentage of low income is not extremely high in these communities, it still peaks where we see wastewater being discharged. The low income plot must also be viewed with the caveat that the data classifies low income as anyone below \$52,992 per year. However, the disparity in the San Francisco Bay makes it so some counties people making even [\$100,000](https://www.ktvu.com/news/all-bay-area-counties-earning-six-figures-can-still-be-considered-low-income) being considered low income. If the data had included an adjusted low income level, the pattern of those in low income communities having their access to nature reduced would become more apparent. 

# References

#### Data

Metropolitan Transportation Commission (MTC). 2021. San Francisco Bay Region Water (area). Retrieved: November 5th 2025 from [opendata.mtc.ca.gov](https://opendata.mtc.ca.gov/datasets/san-francisco-bay-region-water-area/explore) (public)

United States Environmental Protection Agency. 2015. EJSCREEN. Retrieved: November 5th 2025 from [epa.gov](www.epa.gov/ejscreen )

#### Suplimental resources

San Francisco Public Utilities Commission. 2025. Sewer System. Retrieved: November 5th 2025 from [sfpuc.gov](https://www.sfpuc.gov/about-us/our-systems/sewer-system)

KRON4. 2025. Sewer System. In Silicon Valley, just nine households hold 15% of wealth: report. Retrieved: November 5th 2025 from [kron4.com](https://www.kron4.com/news/bay-area/silicon-valley-income-inequality/)

KTVU. 2025. Sewer System. In all Bay Area counties, earning six-figures can still be considered 'low income'. Retrieved: November 5th 2025 from [ktvu.com](https://www.ktvu.com/news/all-bay-area-counties-earning-six-figures-can-still-be-considered-low-income)
